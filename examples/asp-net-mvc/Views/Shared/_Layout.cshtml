<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - My ASP.NET MVC App</title>
    <link rel="stylesheet" href="~/css/site.css" />
</head>
<body>
    <header>
        <nav>
            <!-- Your navigation here -->
        </nav>
    </header>
    
    <div class="container">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <footer>
        <!-- Your footer here -->
    </footer>

    @RenderSection("Scripts", required: false)

    <!-- Session Tracker SDK -->
    @if (Configuration.GetValue<bool>("CandleStick:Enabled"))
    {
        <script src="https://cdn.yourapp.com/candlestick/session-tracker.umd.js"></script>
        <script>
            (function() {
                var tracker = SessionTracker.init({
                    apiEndpoint: '@Configuration["CandleStick:ApiEndpoint"]',
                    userId: '@User.Identity.Name',
                    userName: '@User.Claims.FirstOrDefault(c => c.Type == "name")?.Value',
                    userEmail: '@User.Claims.FirstOrDefault(c => c.Type == "email")?.Value',
                    appName: 'My ASP.NET MVC App',
                    metadata: {
                        environment: '@Environment.EnvironmentName',
                        userRole: '@User.IsInRole("Admin") ? "Admin" : "User"'
                    }
                });
                
                console.log('CandleStick tracking started:', tracker.getSessionId());
            })();
        </script>
    }

</body>
</html>
